import{h as s,p as a}from"./utils-BOqQI58-.js";class l{element;slider;valueDisplay;currentValue;options;constructor(t){this.options={step:.01,value:t.min,displayFormat:"percentage",showValue:!0,...t},this.currentValue=this.options.value,this.createElement(),this.setupEventListeners()}createElement(){if(this.element=document.createElement("div"),this.element.className="slider-control",this.options.className&&this.element.classList.add(this.options.className),this.options.label){const e=document.createElement("label");e.className="slider-label",e.textContent=this.options.label,this.element.appendChild(e)}const t=document.createElement("div");t.className="slider-container",this.slider=document.createElement("input"),this.slider.type="range",this.slider.min=this.options.min.toString(),this.slider.max=this.options.max.toString(),this.slider.step=this.options.step.toString(),this.slider.value=this.currentValue.toString(),this.slider.className="slider",this.options.showValue&&(this.valueDisplay=document.createElement("span"),this.valueDisplay.className="slider-value",this.updateValueDisplay()),t.appendChild(this.slider),this.valueDisplay&&t.appendChild(this.valueDisplay),this.element.appendChild(t),this.updateVisualState()}setupEventListeners(){this.slider.addEventListener("input",t=>{const e=parseFloat(t.target.value);this.currentValue=e,this.updateValueDisplay(),this.updateVisualState(),this.options.onChange&&this.options.onChange(e)})}updateValueDisplay(){if(!this.valueDisplay)return;let t;switch(this.options.displayFormat){case"percentage":const e=(this.currentValue-this.options.min)/(this.options.max-this.options.min)*100;t=`${Math.round(e)}%`;break;case"raw":t=Math.round(this.currentValue).toString();break;case"custom":t=this.options.customFormatter?this.options.customFormatter(this.currentValue):this.currentValue.toString();break;default:t=this.currentValue.toString()}this.valueDisplay.textContent=t}updateVisualState(){this.element.classList.toggle("active",this.currentValue>this.options.min);const t=(this.currentValue-this.options.min)/(this.options.max-this.options.min)*100;this.slider.style.setProperty("--slider-value",`${t}%`)}getElement(){return this.element}getValue(){return this.currentValue}setValue(t){const e=Math.max(this.options.min,Math.min(this.options.max,t));this.currentValue=e,this.slider.value=e.toString(),this.updateValueDisplay(),this.updateVisualState(),this.options.onChange&&this.options.onChange(e)}}class r{element;playBtn;stopBtn;bpmSlider;unsubscribe;options;constructor(t){this.options={initialBPM:120,minBPM:60,maxBPM:200,...t},this.createElement(),this.setupEventHandlers(),this.subscribeToPlaybackState()}createElement(){this.element=document.createElement("div"),this.element.className="transport-controls",this.options.className&&this.element.classList.add(this.options.className);const t=document.createElement("div");t.className="transport-controls-buttons",this.playBtn=document.createElement("span"),this.playBtn.className="transport-controls-btn play-btn",this.playBtn.setAttribute("role","button"),this.playBtn.setAttribute("tabindex","0"),this.playBtn.textContent="▶ Play",this.stopBtn=document.createElement("span"),this.stopBtn.className="transport-controls-btn stop-btn",this.stopBtn.setAttribute("role","button"),this.stopBtn.setAttribute("tabindex","0"),this.stopBtn.textContent="⏹ Stop",t.appendChild(this.playBtn),t.appendChild(this.stopBtn);const e=document.createElement("div");e.className="transport-controls-bpm",this.bpmSlider=new l({label:"BPM",min:this.options.minBPM,max:this.options.maxBPM,step:1,value:this.options.initialBPM,displayFormat:"raw",onChange:n=>{this.options.onBPMChange&&this.options.onBPMChange(Math.round(n))}}),e.appendChild(this.bpmSlider.getElement()),this.element.appendChild(t),this.element.appendChild(e)}setupEventHandlers(){s(this.playBtn,async()=>{this.options.onPlay&&await this.options.onPlay()}),s(this.stopBtn,()=>{this.options.onStop&&this.options.onStop()})}subscribeToPlaybackState(){this.unsubscribe=a.subscribe(t=>{this.updateButtonStates(t)})}updateButtonStates(t){this.playBtn.classList.toggle("active",t==="playing"),this.playBtn.classList.toggle("disabled",t==="playing"),this.stopBtn.classList.toggle("disabled",t==="stopped")}getElement(){return this.element}setBPM(t){this.bpmSlider.setValue(t)}getBPM(){return Math.round(this.bpmSlider.getValue())}dispose(){this.unsubscribe&&this.unsubscribe()}}export{l as S,r as T};
